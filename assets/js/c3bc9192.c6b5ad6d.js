"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[1055],{4689:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>i,contentTitle:()=>d,default:()=>m,frontMatter:()=>s,metadata:()=>a,toc:()=>c});const a=JSON.parse('{"id":"\u77e5\u8bc6\u4e0e\u6280\u80fd\u70b9/\u524d\u7aef\u6c34\u5370/\u524d\u7aef\u6c34\u5370","title":"\u524d\u7aef\u6c34\u5370","description":"\u7f16\u5199\u5de5\u5177\u7c7b","source":"@site/docs/\u77e5\u8bc6\u4e0e\u6280\u80fd\u70b9/\u524d\u7aef\u6c34\u5370/\u524d\u7aef\u6c34\u5370.md","sourceDirName":"\u77e5\u8bc6\u4e0e\u6280\u80fd\u70b9/\u524d\u7aef\u6c34\u5370","slug":"/\u77e5\u8bc6\u4e0e\u6280\u80fd\u70b9/\u524d\u7aef\u6c34\u5370/","permalink":"/zh-summary/docs/\u77e5\u8bc6\u4e0e\u6280\u80fd\u70b9/\u524d\u7aef\u6c34\u5370/","draft":false,"unlisted":false,"editUrl":"https://github.com/qinzhihao-conghua/docs/\u77e5\u8bc6\u4e0e\u6280\u80fd\u70b9/\u524d\u7aef\u6c34\u5370/\u524d\u7aef\u6c34\u5370.md","tags":[],"version":"current","frontMatter":{"title":"\u524d\u7aef\u6c34\u5370"},"sidebar":"tutorialSidebar","previous":{"title":"window\u76f8\u5173","permalink":"/zh-summary/docs/\u77e5\u8bc6\u4e0e\u6280\u80fd\u70b9/window\u76f8\u5173/"},"next":{"title":"\u524d\u7aef\u7406\u8bba\u77e5\u8bc6","permalink":"/zh-summary/docs/\u77e5\u8bc6\u4e0e\u6280\u80fd\u70b9/\u524d\u7aef\u7406\u8bba\u77e5\u8bc6/"}}');var r=t(4848),o=t(8453);const s={title:"\u524d\u7aef\u6c34\u5370"},d=void 0,i={},c=[{value:"\u7f16\u5199\u5de5\u5177\u7c7b",id:"\u7f16\u5199\u5de5\u5177\u7c7b",level:2},{value:"\u4f7f\u7528",id:"\u4f7f\u7528",level:2}];function l(e){const n={code:"code",h2:"h2",p:"p",pre:"pre",...(0,o.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.h2,{id:"\u7f16\u5199\u5de5\u5177\u7c7b",children:"\u7f16\u5199\u5de5\u5177\u7c7b"}),"\n",(0,r.jsx)(n.p,{children:"\u6700\u7b80\u5355\u7684\u65b9\u5f0f\u5c31\u662f\u901a\u8fc7canvas\u751f\u6210\u6587\u5b57\uff0c\u7136\u540e\u8f6c\u6210base64\uff0c\u6700\u540e\u4e22\u5230\u5bbf\u4e3b\u5bb9\u5668\u7684\u80cc\u666f\u4e2d"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-javascript",children:'export default class Watermark {\n    /**\n     * \u8bbe\u7f6e\u6c34\u5370\n     * @param str \u6c34\u5370\u6587\u5b57\n     * @param parentNodeId \u7236\u8282\u70b9id\n     * @param contentWindow iframe\u7684window\u5bf9\u8c61\n     * @param textWidth \u6587\u672c\u533a\u57df\u5bbd\u5ea6\n     * @param textHeight \u6587\u672c\u533a\u57df\u9ad8\u5ea6\n     * @returns \u6c34\u5370dom\u7684id\n     */\n    setWatermark(str: string, parentNodeId: string, contentWindow?: Window, textWidth: number = 140, textHeight: number = 140) {\n        let parentNode = null;\n        let canvas = null;\n        if (contentWindow) {\n            parentNode = contentWindow.document.getElementById(parentNodeId) as HTMLElement;\n            canvas = contentWindow.document.createElement(\'canvas\') as HTMLCanvasElement;\n        } else {\n            parentNode = document.getElementById(parentNodeId) as HTMLElement;\n            canvas = document.createElement(\'canvas\') as HTMLCanvasElement;\n        }\n        canvas.width = textWidth;\n        canvas.height = textHeight;\n        const ctx = canvas.getContext("2d");\n        if (ctx) {\n            ctx.rotate((Math.PI / 120) * -20);\n            ctx.font = "16px Microsoft Yahei";\n            ctx.fillStyle = "rgba(0, 0, 0, 0.5)";\n            ctx.textAlign = "center";\n            ctx.textBaseline = "middle";\n            ctx.fillText(str, textWidth / 10, textHeight / 1.5);\n        }\n        parentNode.style.position = \'relative\';\n        parentNode.style.background = \'url(\' + canvas.toDataURL(\'image/png\') + \') left top repeat\';\n    }\n\n    /**\n     * \u8bbe\u7f6e\u9875\u7709\u9875\u811a\u4e3a\u7a7a\uff0c\u5df2\u65e0\u6548\n     */\n    setHeader() {\n        // \u6dfb\u52a0\u4e00\u4e2a\u95f4\u8ddd\n        let style = document.createElement(\'style\')\n        style.innerHTML = "@page{size: a4;margin:" + \'10mm\' + "}"\n        window.document.head.appendChild(style);\n        //\u8bbe\u7f6e\u9875\u7709\u9875\u811a\u4e3a\u7a7a\n        let hkey_root, hkey_path, hkey_key;\n        hkey_root = "HKEY_CURRENT_USER";\n        hkey_path = "\\\\Software\\\\Microsoft\\\\Internet Explorer\\\\PageSetup\\\\";\n        // let RegWsh = new ActiveXObject("WScript.Shell");\n        // hkey_key = "header";\n        // RegWsh.RegWrite(hkey_root + hkey_path + hkey_key, "");\n        // hkey_key = "footer";\n        // RegWsh.RegWrite(hkey_root + hkey_path + hkey_key, "");\n    }\n    /**\n     * \u5220\u9664\u6c34\u5370\u7ed3\u70b9\n     * @param id \u6c34\u5370id\n     * @param parentNodeId \u6c34\u5370\u7236\u5bb9\u5668id \n     */\n    removeWatermark(parentNodeId: string, contentWindow?: Window) {\n        let parentNode = null;\n        if (contentWindow) {\n            parentNode = contentWindow.document.getElementById(parentNodeId) as HTMLElement;\n        } else {\n            parentNode = document.getElementById(parentNodeId) as HTMLElement;\n        }\n        parentNode.style.background = \'unset\';\n    }\n}\n'})}),"\n",(0,r.jsx)(n.h2,{id:"\u4f7f\u7528",children:"\u4f7f\u7528"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-javascript",children:"const watermark = new Watermark();\nwatermark.setWatermark('\u6d4b\u8bd5\u6c34\u5370', 'printid');\nwatermark.removeWatermark('printid');\n"})})]})}function m(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(l,{...e})}):l(e)}},8453:(e,n,t)=>{t.d(n,{R:()=>s,x:()=>d});var a=t(6540);const r={},o=a.createContext(r);function s(e){const n=a.useContext(o);return a.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function d(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:s(e.components),a.createElement(o.Provider,{value:n},e.children)}}}]);